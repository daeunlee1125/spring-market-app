<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>kmarket/admin - Final Version</title>
    <!-- Font Awesome 아이콘 라이브러리 -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <!-- Daum 우편번호 서비스를 위한 스크립트 -->
    <script src="//t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
    <link rel="stylesheet" th:href="@{/css/admin/common.css}">
    <link rel="stylesheet" th:href="@{/css/admin/main.css}">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <aside class="sidebar">
        <div class="sidebar-header">
            SHOPLY Admin
        </div>
        <nav>
            <ul class="mainSideBar">
                <li th:if="${#authentication.principal.member.mem_level==7}">
                    <div><i class="fas fa-cog"></i> 환경설정</div>
                    <ul class="subSideBar">
                        <li><a th:href="@{/admin/config/basic}">기본설정</a></li>
                        <li><a th:href="@{/admin/config/banner}">배너관리</a></li>
                        <li><a th:href="@{/admin/config/policy}">약관관리</a></li>
                        <li><a th:href="@{/admin/config/category}">카테고리</a></li>
                        <li><a th:href="@{/admin/config/version}">버전관리</a></li>
                    </ul>
                </li>
                <li>
                    <div><i class="fas fa-store"></i> 상점관리</div>
                    <ul class="subSideBar">
                        <li><a th:href="@{/admin/shop/list}">상점목록</a></li>
                        <li><a th:href="@{/admin/shop/sales}">매출현황</a></li>
                    </ul>
                </li>
                <li>
                    <div><i class="fas fa-users"></i> 회원관리</div>
                    <ul class="subSideBar">
                        <li><a th:href="@{/admin/member/list}">회원목록</a></li>
                        <li><a th:href="@{/admin/member/point}">포인트관리</a></li>
                    </ul>
                </li>
                <li>
                    <div><i class="fas fa-box-open"></i> 상품관리</div>
                    <ul class="subSideBar">
                        <li><a th:href="@{/admin/product/list}">상품목록</a></li>
                        <li><a th:href="@{/admin/product/register}">상품등록</a></li>
                    </ul>
                </li>
                <li>
                    <div><i class="fas fa-truck"></i> 주문관리</div>
                    <ul class="subSideBar">
                        <li><a th:href="@{/admin/order/list}">주문현황</a></li>
                        <li><a th:href="@{/admin/order/delivery}">배송현황</a></li>
                    </ul>
                </li>
                <li>
                    <div><i class="fas fa-ticket-alt"></i> 쿠폰관리</div>
                    <ul class="subSideBar">
                        <li><a th:href="@{/admin/coupon/list}">쿠폰목록</a></li>
                        <li><a th:href="@{/admin/coupon/issued}">쿠폰발급현황</a></li>
                    </ul>
                </li>
                <li th:if="${#authentication.principal.member.mem_level==7}">
                    <div><i class="fas fa-headset"></i> 고객센터</div>
                    <ul class="subSideBar">
                        <li><a th:href="@{/admin/cs/notice/list}">공지사항</a></li>
                        <li><a th:href="@{/admin/cs/faq/list}">자주묻는질문</a></li>
                        <li><a th:href="@{/admin/cs/qna/list}">문의하기</a></li>
                    </ul>
                </li>
            </ul>
        </nav>
    </aside>

    <header>
        <div class="middle">
            <div id="logo">
                <a th:href="@{/}"><img th:src="@{/image/logo.jpg}" alt="logo"></a>
            </div>

            <div class="header-nav">
                <ul class="header-menu">
                    <li><a th:href="@{/admin/}">홈</a></li>
                    <li><a th:href="@{/member/logout}">로그아웃</a></li>
                    <li><a th:href="@{/admin/cs/notice/list}">고객센터</a></li>
                </ul>
            </div>
        </div>
    </header>

    

    <div class="main">
        <div class="middle main-content">
            <div class="main-common">
                <div class="main-head">
                    <div>
                        <h3>관리자메인</h3>
                    </div>
                    <div class="main-head-right">
                        <a href="">HOME</a>
                        <div>
                            &nbsp;>&nbsp;
                        </div>
                        <a href="" class="nav-last">관리자 메인</a>
                    </div>
                </div>
                <div class="main-content-top">

                </div>
                <main>
                    <div class="admin-main-box">
                        <!-- 집계현황 -->
                        <section class="dashboard">
                            <h4>집계현황</h4>
                            <div class="dashboard-charts">
                                <div class="chart-box">
                                    <h5>결제현황</h5>
                                    <canvas id="orderChart" width="200" height="150"></canvas>
                                </div>
                                <script th:inline="javascript">
                                    const stats = /*[[${chart}]]*/ [];


                                    const labels = stats.map(s => s.ch_date);
                                    const orderCnt = stats.map(s => s.order_cnt);
                                    const payCnt = stats.map(s => s.pay_cnt);
                                    const cancelCnt = stats.map(s => s.cancel_cnt);

                                    new Chart(document.getElementById('orderChart'), {
                                        type: 'bar',
                                        data: {
                                            labels,
                                            datasets: [
                                                { label: '주문', data: orderCnt, backgroundColor: '#4f7ecc' },
                                                { label: '결제', data: payCnt, backgroundColor: '#52b878' },
                                                { label: '취소', data: cancelCnt, backgroundColor: '#c54242' }
                                            ]
                                        },
                                        options: {
                                            responsive: true,
                                            plugins: {
                                                legend: { position: 'top' },

                                            },
                                            scales: {
                                                y: { beginAtZero: true,
                                                    ticks: {
                                                        stepSize: 1       // 눈금 간격을 1로 설정
                                                    }}
                                            }
                                        }
                                    });
                                </script>
                                <div class="chart-box">
                                    <h5>주요매출</h5>
                                    <canvas id="salesChart" width="200" height="200"></canvas>
                                </div>
                                <script th:inline="javascript">
                                    const RAW = /*[[${chart2}]]*/ [];

                                    const labels2 = RAW.map(r => r.cate1_name);
                                    const data = RAW.map(r => r.cate1_sell);

                                    new Chart(document.getElementById('salesChart'), {
                                        type: 'pie',
                                        data: {
                                            labels: labels2,
                                            datasets: [{
                                                data,
                                                backgroundColor: ['#5d89d3', '#c63a3a', '#8ebf41', '#7439b5', '#f97316'],
                                                borderWidth: 0
                                            }]
                                        },
                                        options: {
                                            responsive: true,
                                            plugins: {
                                                legend: { position: 'bottom' }
                                            }
                                        }
                                    });
                                </script>
                            </div>
                    </section>

                    <section class="status">
                        <h4>운영현황</h4>
                        <table class="status-bottom">
                            <thead>
                                <tr>
                                    <th>입금대기</th>
                                    <th>배송준비</th>
                                    <th>취소요청</th>
                                    <th>교환요청</th>
                                    <th>반품요청</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="main-row">
                                    <td>[[${info.st1}]]</td>
                                    <td>[[${info.st1Total}]]</td>
                                    <td>[[${info.st3}]]</td>
                                    <td>[[${info.st5Total}]]</td>
                                    <td>[[${info.st6Total}]]</td>
                                </tr>
                            </tbody>
                        </table>

                        <table class="status-bottom">
                            <thead>
                                <tr>
                                    <th>주문건수</th>
                                    <th>주문금액</th>
                                    <th>회원가입</th>
                                    <th>방문자 수</th>
                                    <th>문의 게시물</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr class="main-row">
                                    <td>[[${info.ordNum}]]</td>
                                    <td>[[${#numbers.formatInteger(info.ordTotal, 3, 'COMMA')}]]</td>
                                    <td>[[${info.regTotal}]]</td>
                                    <td>[[${info.visit}]]</td>
                                    <td>[[${info.qnaTotal}]]</td>
                                </tr>
                                <tr class="sub-row">
                                    <td>
                                        <table class="mini-table">
                                            <tr><td>오늘</td><td>[[${info.todOrdNum}]]</td></tr>
                                            <tr><td>어제</td><td>[[${info.yesOrdNum}]]</td></tr>
                                        </table>
                                    </td>
                                    <td>
                                        <table class="mini-table">
                                            <tr><td>오늘</td><td>[[${info.todOrdTotal == 0 ? 0 : #numbers.formatInteger(info.todOrdTotal, 3, 'COMMA')}]]</td></tr>
                                            <tr><td>어제</td><td>[[${info.yesOrdTotal == 0 ? 0 : #numbers.formatInteger(info.yesOrdTotal, 3, 'COMMA')}]]</td></tr>
                                        </table>
                                    </td>
                                    <td>
                                        <table class="mini-table">
                                            <tr><td>오늘</td><td>[[${info.todRegTotal}]]</td></tr>
                                            <tr><td>어제</td><td>[[${info.yesRegTotal}]]</td></tr>
                                        </table>
                                    </td>
                                    <td>
                                        <table class="mini-table">
                                            <tr><td>오늘</td><td>[[${info.todVisit}]]</td></tr>
                                            <tr><td>어제</td><td>[[${info.yesVisit}]]</td></tr>
                                        </table>
                                    </td>
                                    <td>
                                        <table class="mini-table">
                                            <tr><td>오늘</td><td>[[${info.todQnaTotal}]]</td></tr>
                                            <tr><td>어제</td><td>[[${info.yesQnaTotal}]]</td></tr>
                                        </table>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </section>





                    <!-- 공지사항 & 고객문의 -->
                    <section class="board">
                        <div class="board-box">
                            <h4>공지사항</h4>
                            <ul>
                                <li th:each="notice : ${notList}">
                                    <div class="title">
                                        <a th:href="@{'/admin/cs/notice/view/' + ${notice.cs_no}}">
                                            [ [[${notice.cs_type}]] ] [[${notice.cs_title}]]
                                        </a>
                                    </div>
                                    <div class="writer"></div> <!-- 공지사항은 작성자 X -->
                                    <div class="date">[[${notice.cs_rdate}]]</div>
                                </li>
                            </ul>
                        </div>

                        <div class="board-box">
                            <h4>고객문의</h4>
                            <ul>
                                <li th:each="qna : ${qnaList}">
                                    <a th:if="${qna.q_reply != null}"
                                       th:href="@{/admin/cs/qna/view(qNo=${qna.q_no})}">
                                        <div class="title">[ [[${qna.q_cate2}]] ] [[${qna.q_title}]]</div>
                                    </a>
                                    <a th:unless="${qna.q_reply != null}"
                                       th:href="@{/admin/cs/qna/reply(qNo=${qna.q_no})}">
                                        <div class="title">[ [[${qna.q_cate2}]] ] [[${qna.q_title}]]</div>
                                    </a>
                                    <div class="writer">[[${qna.masked_id}]]</div>
                                    <div class="date">[[${qna.q_rdate}]]</div>
                                </li>
                            </ul>
                        </div>
                    </section>
                </div>
            </main>
            </div>
        </div>
    </div>

    <footer>
        <div class="middle">
            <p id="footer-p" th:text="${copyrightDTO.getSCopy()} + '.' + ${copyrightDTO.getSTitle()} + ' ADMINISTRATOR Version ' + ${copyrightDTO.getVerVersion()}">
                Copyright ©shoply.co.kr All rights reserved. shoply ADMINISTRATOR Version 0.0.4-SNAPSHOT
            </p>
        </div>
    </footer>

    <!-- 모달(팝업) HTML -->
    <div class="modal-overlay hidden" id="modal">
        <div class="modal-popup">
            <div class="modal-header">
                <h2>상점등록</h2>
                <button class="close-btn" id="closeModalBtn">&times;</button>
            </div>
            <div class="modal-content">
                <hr>
                <div class="form-group">
                    <label for="id">아이디</label>
                    <input type="text" id="id">
                    <span class="description">영문, 숫자 4~12자 설정</span>
                </div>
                <div class="form-group">
                    <label for="password">비밀번호</label>
                    <input type="password" id="password">
                     <span class="description">영문, 숫자, 특수문자 8~12자 설정</span>
                </div>
                <div class="form-group">
                    <label for="password-confirm">비밀번호확인</label>
                    <input type="password" id="password-confirm">
                </div>
                <hr>
                <div class="form-group">
                    <label for="store-name">상호명</label>
                    <input type="text" id="store-name" placeholder="상호명입력 예) (주)">
                </div>
                <div class="form-group">
                    <label for="ceo-name">대표</label>
                    <input type="text" id="ceo-name" placeholder="이름입력">
                </div>
                <div class="form-group">
                    <label for="biz-reg-num">사업자등록번호</label>
                    <input type="text" id="biz-reg-num">
                    <span class="description">- 포함 12자리 입력</span>
                </div>
                 <div class="form-group">
                    <label for="ecom-reg-num">통신판매업번호</label>
                    <input type="text" id="ecom-reg-num">
                    <span class="description">- 포함 12자리 입력</span>
                </div>
                <div class="form-group">
                    <label for="tel">전화번호</label>
                    <input type="text" id="tel">
                </div>
                <div class="form-group">
                    <label for="fax">팩스</label>
                    <input type="text" id="fax">
                </div>
                <div class="form-group">
                    <label for="zipcode">주소</label>
                    <input type="text" id="zipcode" placeholder="우편번호" readonly>
                    <button type="button" id="searchAddressBtn" class="search-btn">우편번호 검색</button>
                </div>
                <div class="form-group">
                    <label for="address"></label>
                    <input type="text" id="address" placeholder="기본주소" readonly>
                </div>
                <div class="form-group">
                    <label for="address-detail"></label>
                    <input type="text" id="address-detail" placeholder="상세주소입력">
                </div>
                <hr>
            </div>
            <div class="modal-footer">
                <button>등록하기</button>
            </div>
        </div>
    </div>

    


</body>
</html>
