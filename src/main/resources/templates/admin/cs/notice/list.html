<div th:replace="~{admin/cs/notice/_head.html}"></div>

  <!-- 메인 -->
  <div class="main">
    <div class="middle main-content">
      <div class="main-common">
        <div class="main-head">
          <div><h3>공지사항 목록</h3></div>
          <div class="main-head-right">
            <a href="#">HOME</a><div>&nbsp;>&nbsp;</div>
            <a href="#">고객센터</a><div>&nbsp;>&nbsp;</div>
            <a href="#" class="nav-last">공지사항</a>
          </div>
        </div>


          <!-- 검색 영역 -->
          <div class="main-content-top" style="border:none; margin:15px 0;">
              <form class="search-bar" th:action="@{/admin/cs/notice/list}" method="get">
                  <select name="csType" onchange="this.form.submit()">
                      <option value="">유형선택</option>
                      <option value="전체">전체 글 보기</option>
                      <option th:value="'고객서비스'" th:selected="${param.csType == '고객서비스'}">고객서비스</option>
                      <option th:value="'이벤트당첨'" th:selected="${param.csType == '이벤트당첨'}">이벤트 당첨</option>
                      <option th:value="'안전거래'" th:selected="${param.csType == '안전거래'}">안전거래</option>
                      <option th:value="'위해상품'" th:selected="${param.csType == '위해상품'}">위해상품</option>
                  </select>
              </form>
          </div>

    <main>
        <table class="table">
        <thead>
            <tr>
            <th class="checkbox-cell" id="selectAll" onclick="toggleAll(this)">
                <input type="checkbox">
            </th>
            <th>번호</th>
            <th>유형</th>
            <th>제목</th>
            <th>조회</th>
            <th>날짜</th>
            <th>관리</th>
            </tr>
        </thead>
            <tbody>
            <tr th:each="notice : ${pageResponse.dtoList}">
                <td><input type="checkbox" name="itemCheck"></td>
                <td th:text="${notice.cs_no}"></td>
                <td th:text="${notice.cs_type}"></td>
                <td>
                    <a th:href="@{'/admin/cs/notice/view/' + ${notice.cs_no}}"
                       th:text="${notice.cs_title}"></a>
                </td>
                <td th:text="${notice.cs_hit}"></td>
                <td th:text="${notice.cs_rdate}"></td>
                <td>
                    <a th:href="@{'/admin/cs/notice/delete/' + ${notice.cs_no}}"
                       onclick="return confirm('정말 삭제하시겠습니까?');">[삭제]</a>
                    <a th:href="@{'/admin/cs/notice/modify/' + ${notice.cs_no}}">[수정]</a>
                </td>
            </tr>
            </tbody>

        </table>

        <!-- 페이지네이션 -->
        <div class="page">
            <a th:if="${pageResponse.prev}"
               th:href="@{/admin/cs/notice/list(pg=${pageResponse.start - 1}, size=${pageResponse.size}, csType=${csType})}">
                이전
            </a>

            <a th:each="num : ${#numbers.sequence(pageResponse.start, pageResponse.end)}"
               th:href="@{/admin/cs/notice/list(pg=${num}, size=${pageResponse.size}, csType=${csType})}"
               th:classappend="${num == pageResponse.pg} ? 'current'"
               th:text="${num}">
            </a>

            <a th:if="${pageResponse.next}"
               th:href="@{/admin/cs/notice/list(pg=${pageResponse.end + 1}, size=${pageResponse.size}, csType=${csType})}">
                다음
            </a>
        </div>

    <!-- 버튼 영역 -->
        <!-- 버튼 영역 -->
        <div class="button-container">
            <div class="left-buttons">
                <button type="button" class="openModalBtn delete-btn" data-target="confirmEndModal">
                    선택삭제
                </button>
            </div>
            <div class="right-buttons">
                <a th:href="@{/admin/cs/notice/write}" class="register-btn">
                    작성하기
                </a>
            </div>
        </div>



        <form id="deleteForm" th:action="@{/admin/cs/notice/delete}" method="post">
            <input type="hidden" name="deleteIds" id="deleteIds">
        </form>



    </main>
</div>
</div>
</div>

<!-- 종료 확인 모달 -->
<div class="modal hidden" id="confirmEndModal">
    <div class="modal-popup">
        <div class="modal-header">
            <h2>선택삭제 확인</h2>
            <span class="closeModalBtn">&times;</span>
        </div>
        <div class="modal-content">
            <p>해당 공지사항 목록을 삭제하시겠습니까?</p>
            <div style="text-align:center; margin-top:20px;">
                <button class="register-btn">확인</button>
                <button class="closeModalBtn delete-btn">취소</button>
            </div>
        </div>
    </div>
</div>


  <div th:replace="~{admin/cs/notice/_tail.html}"></div>






<script>
    document.addEventListener('DOMContentLoaded', () => {
        const deleteBtn = document.querySelector('#confirmEndModal .register-btn');
        const checkboxes = document.querySelectorAll('input[name="itemCheck"]');
        const deleteForm = document.getElementById('deleteForm');
        const deleteIdsInput = document.getElementById('deleteIds');

        // 전체 선택 토글
        document.querySelector('#selectAll input').addEventListener('change', (e) => {
            checkboxes.forEach(cb => cb.checked = e.target.checked);
        });

        // 모달 '확인' 버튼 클릭 → 선택된 항목 삭제
        deleteBtn.addEventListener('click', () => {
            const selected = Array.from(checkboxes)
                .filter(cb => cb.checked)
                .map(cb => cb.closest('tr').querySelector('td:nth-child(2)').innerText.trim());

            if (selected.length === 0) {
                alert("삭제할 항목을 선택해주세요.");
                return;
            }

            deleteIdsInput.value = selected.join(',');
            deleteForm.submit();
        });
    });
</script>

</body>
</html>


