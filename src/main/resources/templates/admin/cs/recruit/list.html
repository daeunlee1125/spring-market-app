<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>채용하기 목록 - SHOPLY Admin</title>
  <link rel="stylesheet" th:href="@{https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css}">
  <link rel="stylesheet" th:href="@{/css/admin/common.css}">
  <link rel="stylesheet" th:href="@{/css/admin/cs.css}">
  <link rel="stylesheet" th:href="@{/css/admin/coupon.css}">

</head>
<body>
<aside class="sidebar">
    <div class="sidebar-header">
        SHOPLY Admin
    </div>
    <nav>
        <ul class="mainSideBar">
            <li>
                <div><i class="fas fa-cog"></i> 환경설정</div>
                <ul class="subSideBar">
                    <li><a th:href="@{/admin/config/basic}">기본설정</a></li>
                    <li><a th:href="@{/admin/config/banner}">배너관리</a></li>
                    <li><a th:href="@{/admin/config/policy}">약관관리</a></li>
                    <li><a th:href="@{/admin/config/category}">카테고리</a></li>
                    <li><a th:href="@{/admin/config/version}">버전관리</a></li>
                </ul>
            </li>
            <li>
                <div><i class="fas fa-store"></i> 상점관리</div>
                <ul class="subSideBar">
                    <li><a th:href="@{/admin/shop/list}">상점목록</a></li>
                    <li><a th:href="@{/admin/shop/sales}">매출현황</a></li>
                </ul>
            </li>
            <li>
                <div><i class="fas fa-users"></i> 회원관리</div>
                <ul class="subSideBar">
                    <li><a th:href="@{/admin/member/list}">회원목록</a></li>
                    <li><a th:href="@{/admin/member/point}">포인트관리</a></li>
                </ul>
            </li>
            <li>
                <div><i class="fas fa-box-open"></i> 상품관리</div>
                <ul class="subSideBar">
                    <li><a th:href="@{/admin/product/list}">상품목록</a></li>
                    <li><a th:href="@{/admin/product/register}">상품등록</a></li>
                </ul>
            </li>
            <li>
                <div><i class="fas fa-truck"></i> 주문관리</div>
                <ul class="subSideBar">
                    <li><a th:href="@{/admin/order/list}">주문현황</a></li>
                    <li><a th:href="@{/admin/order/delivery}">배송현황</a></li>
                </ul>
            </li>
            <li>
                <div><i class="fas fa-ticket-alt"></i> 쿠폰관리</div>
                <ul class="subSideBar">
                    <li><a th:href="@{/admin/coupon/list}">쿠폰목록</a></li>
                    <li><a th:href="@{/admin/coupon/issued}">쿠폰발급현황</a></li>
                </ul>
            </li>
            <li>
                <div><i class="fas fa-headset"></i> 고객센터</div>
                <ul class="subSideBar">
                    <li><a th:href="@{/admin/cs/notice/list}">공지사항</a></li>
                    <li><a th:href="@{/admin/cs/faq/list}">자주묻는질문</a></li>
                    <li><a th:href="@{/admin/cs/qna/list}">문의하기</a></li>
                    <li><a th:href="@{/admin/cs/recruit/list}">채용관리</a></li>
                </ul>
            </li>
        </ul>
    </nav>
</aside>
<!-- 헤더 -->
<header>
    <div class="middle">
        <div id="logo">
            <a th:href="@{/}"><img th:src="@{/image/logo.jpg}" alt="logo"></a>
        </div>

        <div class="header-nav">
            <ul class="header-menu">
                <li><a th:href="@{/admin/}">홈</a></li>
                <li><a th:href="@{/member/logout}">로그아웃</a></li>
                <li><a th:href="@{/admin/cs/notice/list}">고객센터</a></li>
            </ul>
        </div>
    </div>
</header>

  <!-- 메인 -->
  <div class="main">
    <div class="middle main-content">
      <div class="main-common">
        <div class="main-head">
          <div><h3>채용하기 목록</h3></div>
          <div class="main-head-right">
            <a href="#">HOME</a><div>&nbsp;>&nbsp;</div>
            <a href="#">고객센터</a><div>&nbsp;>&nbsp;</div>
            <a href="#" class="nav-last">채용하기</a>
          </div>
        </div>

        <!-- 검색 영역 -->
          <div class="main-content-top" style="border:none; margin:15px 0;">
              <form class="search-bar" method="get" th:action="@{/admin/cs/recruit/list}">
                  <select name="searchType" th:value="${response.searchType}">
                      <option value="">검색조건 선택</option>
                      <option value="n" th:selected="${response.searchType=='n'}">채용번호</option>
                      <option value="t" th:selected="${response.searchType=='t'}">제목</option>
                      <option value="d" th:selected="${response.searchType=='d'}">채용부서</option>
                      <option value="e" th:selected="${response.searchType=='e'}">경력사항</option>
                      <option value="j" th:selected="${response.searchType=='j'}">채용형태</option>
                      <option value="s" th:selected="${response.searchType=='s'}">상태</option>
                  </select>
                  <input type="text" name="keyword" placeholder="검색어 입력" th:value="${response.keyword}"
                         style="border:1px solid #ccc; height:23px; padding:5px 8px; outline:none; background-color:#fff;">
                  <button type="submit">검색</button>
              </form>
          </div>
    <main>
        <table class="table">
            <thead>
            <tr>
                <th class="checkbox-cell" id="selectAll">
                    <input type="checkbox" id="selectAllBox">
                </th>
                <th>번호</th>
                <th>채용부서</th>
                <th>경력사항</th>
                <th>채용형태</th>
                <th>제목</th>
                <th>상태</th>
                <th>모집기간</th>
                <th>작성일</th>
            </tr>
            </thead>
            <tbody>
            <tr th:if="${#lists.isEmpty(response.dtoList)}">
                <td colspan="9">등록된 채용 공고가 없습니다.</td>
            </tr>

            <tr th:each="recruit : ${response.dtoList}">
                <td><input type="checkbox" name="itemCheck" th:value="${recruit.rec_no}"></td>
                <td th:text="${recruit.rec_no}"></td>
                <td th:text="${recruit.rec_department}"></td>
                <td th:text="${recruit.rec_experience}"></td>
                <td th:text="${recruit.rec_job_type}"></td>
                <td>
                    <a th:href="@{|/admin/cs/recruit/read?recNo=${recruit.rec_no}|}" th:text="${recruit.rec_title}"></a>
                </td>
                <td th:text="${recruit.rec_status}"></td>
                <td>
                    <span th:text="${recruit.rec_start_time}"></span> ~
                    <span th:text="${recruit.rec_end_date}"></span>
                </td>
                <td th:text="${recruit.rec_rdate}"></td>
            </tr>
            </tbody>
        </table>

        <!-- 페이지네이션 -->
        <div class="page">
            <a th:if="${response.prev}"
               th:href="@{|/admin/cs/recruit/list?pg=${response.start-1}&searchType=${response.searchType}&keyword=${response.keyword}|}"
               class="prev">이전</a>

            <a th:each="p : ${#numbers.sequence(response.start, response.end)}"
               th:href="@{|/admin/cs/recruit/list?pg=${p}&searchType=${response.searchType}&keyword=${response.keyword}|}"
               th:classappend="${p==response.pg} ? ' current' : ''"
               class="num"
               th:text="${p}">1</a>

            <a th:if="${response.next}"
               th:href="@{|/admin/cs/recruit/list?pg=${response.end+1}&searchType=${response.searchType}&keyword=${response.keyword}|}"
               class="next">다음</a>
        </div>

        <!-- 버튼 영역 -->
        <div class="button-container">
            <div class="left-buttons">
                <button type="button" class="openModalBtn delete-btn" data-target="confirmEndModal">선택삭제</button>
            </div>
            <div class="right-buttons">
                <button type="button" class="openModalBtn register-btn" data-target="recruitRegisterModal">채용등록</button>
            </div>
        </div>
    </main>
      </div>
    </div>
  </div>

<!-- 푸터 -->
<footer>
    <div class="middle">
        <p id="footer-p">
            Copyright ©Kmarket.co.kr All rights reserved.
        </p>
    </div>
</footer>

<!-- 선택삭제 확인 모달 -->
<div class="modal hidden" id="confirmEndModal">
    <div class="modal-popup">
        <div class="modal-header">
            <h2>선택삭제 확인</h2>
            <span class="closeModalBtn">&times;</span>
        </div>
        <div class="modal-content">
            <p>해당 채용하기 목록을 삭제하시겠습니까?</p>
            <div>
                <button type="button" id="confirmDeleteBtn">확인</button>
                <button type="button" class="closeModalBtn">취소</button>
            </div>
        </div>
    </div>
</div>

<!-- 채용등록 모달 -->
<div class="modal hidden" id="recruitRegisterModal">
    <div class="modal-popup large">
        <div class="modal-header">
            <h2>채용등록</h2>
            <button type="button" class="closeModalBtn">&times;</button>
        </div>
        <div class="modal-content">
            <form method="post" th:action="@{/admin/cs/recruit/register}">

                <div class="form-group">
                    <label>제목</label>
                    <input type="text" name="rec_title">
                </div>

                <div class="form-group">
                    <label>채용부서</label>
                    <select name="rec_department">
                        <option>IT</option>
                        <option>운영</option>
                        <option>광고사업</option>
                        <option>경영</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>경력사항</label>
                    <select name="rec_experience">
                        <option>신입</option>
                        <option>경력</option>
                        <option>무관</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>채용형태</label>
                    <select name="rec_job_type">
                        <option>정규직</option>
                        <option>계약직</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>모집기간</label>
                    <div>
                        <input type="date" name="rec_start_date"> ~
                        <input type="date" name="rec_end_date">
                    </div>
                </div>

                <div class="form-group">
                    <label>상태</label>
                    <select name="rec_status">
                        <option>모집중</option>
                        <option>마감</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>자격요건</label>
                    <input type="text" name="rec_qualification" class="long-input">
                </div>

                <div class="form-group">
                    <label>복지/비고</label>
                    <input type="text" name="rec_welfare" class="long-input">
                </div>

                <div class="form-group">
                    <label>상세내용</label>
                    <input type="text" name="rec_content" class="long-input">
                </div>

                <!-- 버튼 -->
                <div style="text-align:center; margin-top:20px;">
                    <button type="button" class="closeModalBtn delete-btn">취소</button>
                    <button type="submit" class="register-btn">등록</button>
                </div>
            </form>
        </div>
    </div>
</div>


<!-- 선택삭제용 히든 폼 -->
<form id="bulkDeleteForm" method="post" th:action="@{/admin/cs/recruit/remove}">
    <input type="hidden" name="ids" id="idsField">
</form>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const selectAll = document.getElementById('selectAllBox');
        if (selectAll) {
            selectAll.addEventListener('change', () => {
                document.querySelectorAll('input[name="itemCheck"]').forEach(cb => cb.checked = selectAll.checked);
            });
        }

        document.querySelectorAll(".openModalBtn").forEach(btn => {
            btn.addEventListener("click", (e) => {
                e.preventDefault();
                const modal = document.getElementById(btn.dataset.target);
                if (modal) modal.classList.remove("hidden");
            });
        });

        document.querySelectorAll(".modal").forEach(modal => {
            modal.addEventListener("click", (e) => {
                if (e.target.classList.contains("closeModalBtn") || e.target === modal) {
                    modal.classList.add("hidden");
                }
            });
        });

        const confirmBtn = document.getElementById("confirmDeleteBtn");
        if (confirmBtn) {
            confirmBtn.addEventListener("click", () => {
                const checked = document.querySelectorAll('input[name="itemCheck"]:checked');
                if (!checked.length) {
                    alert("삭제할 항목을 선택하세요.");
                    return;
                }
                const ids = Array.from(checked).map(el => el.value);
                document.getElementById('idsField').value = ids.join(',');
                document.getElementById('bulkDeleteForm').submit();
            });
        }
    });
</script>

</body>
</html>