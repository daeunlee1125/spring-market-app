<div th:replace="~{my/_head.html}"></div>

<main class="container">
    <div class="sidebar">
        <ul>
            <li><a th:href="@{/my/home}">마이페이지 홈</a></li>
            <li><a th:href="@{/my/order}">전체주문내역</a></li>
            <li><a th:href="@{/my/point}">포인트내역</a></li>
            <li><a th:href="@{/my/coupon}" class="active">쿠폰</a></li>
            <li><a th:href="@{/my/review}">나의리뷰</a></li>
            <li><a th:href="@{/my/qna}">문의하기</a></li>
            <li><a th:href="@{/my/info}">나의설정</a></li>
        </ul>
    </div>
    <div class="content">
        <div class="main-content-header">
            <h2>나의 쇼핑 정보</h2>
            <div class="info-summary">
                <div class="info-item">
                    <div class="count" th:text="${orderCount}">2</div>
                    <div>주문</div>
                </div>
                <div class="info-item">
                    <div class="count" th:text="${couponCount}">1</div>
                    <div>쿠폰</div>
                </div>
                <div class="info-item">
                    <div class="count" th:text="${#numbers.formatInteger(pointTotal, 0, 'COMMA')}">1,000</div>
                    <div>포인트</div>
                </div>
                <div class="info-item">
                    <div class="count" th:text="${qnaCount}">1</div>
                    <div>문의</div>
                </div>
            </div>
        </div>

        <div class="banner">
            810 x 86 배너 광고
        </div>

        <div class="coupon-section">
            <h3>쿠폰내역</h3>
            <table class="coupon-table">
                <thead>
                <tr>
                    <th>쿠폰명</th>
                    <th>할인금액</th>
                    <th>적용기준 / 제한조건</th>
                    <th>상태</th>
                    <th>유효기간</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="coupon : ${couponPage.content}">
                    <td th:text="${coupon.cp_name}">1만원 할인 중복쿠폰</td>
                    <!-- ✅ cp_type이 3이면 배송비 무료, 아니면 할인금액 표시 -->
                    <td th:switch="${coupon.cp_type}">
                        <span th:case="3">배송비 무료</span>
                        <span th:case="*" th:text="${#numbers.formatInteger(coupon.cp_value, 0, 'COMMA')} + '원'"></span>
                    </td>
                    <td>
                        <span th:text="${#numbers.formatInteger(coupon.cp_min_price, 0, 'COMMA')} + '원 이상 구매시'">10,000원 이상 구매시</span>
                        <span th:if="${coupon.cp_type == 1}">(중복 가능)</span>
                    </td>
                    <td>
                        <!-- cp_stat: 0-사용, 1-사용가능, 2-발급중단, 3-발급종료 -->
                        <span th:if="${coupon.cp_stat == 0}" style="color: #999;">사용완료</span>
                        <span th:if="${coupon.cp_stat == 1}" style="color: #946ccf; font-weight: bold;">사용가능</span>
                        <span th:if="${coupon.cp_stat == 2}" style="color: #ff6b6b;">발급중단</span>
                        <span th:if="${coupon.cp_stat == 3}" style="color: #999;">발급종료</span>
                    </td>
                    <td th:text="${coupon.cp_exp_date != null ? #dates.format(coupon.cp_exp_date, 'yyyy-MM-dd') : '기간 없음'}"></td>
                </tr>
                <tr th:if="${#lists.isEmpty(couponPage.content)}">
                    <td colspan="5" style="text-align: center;">쿠폰 내역이 없습니다.</td>
                </tr>
                </tbody>
            </table>
        </div>

        <div class="info-section">
            <h3>쿠폰사용안내</h3>
            <ul class="info-text">
                <li>현금/골드/환불/상품권 등 현금성 카테고리 및 일부 프로모션 상품에는 쿠폰 사용이 제한됩니다.</li>
                <li>상품/구매/할인 쿠폰은 한 상품당 한 장만 사용 가능하며, 총 주문금액이 일정 금액 이상일 경우에만 사용 가능합니다.</li>
                <li>쿠폰은 쿠폰 한정으로 적용되므로, 사용 시 유의하시기 바랍니다.</li>
                <li>쿠폰은 회원당 한 번씩만 발행되며, 재발행이 불가능합니다.</li>
                <li>유효기간이 지난 쿠폰은 자동 소멸됩니다.</li>
            </ul>
        </div>

        <div style="text-align: center; margin: 30px 0; padding: 20px; background: #f9f9f9; border-radius: 8px;">
            <a th:if="${couponPage.number > 0}"
               th:href="@{/my/coupon(page=0)}"
               style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
              border: 1px solid #ddd; border-radius: 6px; margin: 0 2px;
              background: #fff; color: #946ccf; text-decoration: none; font-weight: bold;">«</a>
            <span th:unless="${couponPage.number > 0}"
                  style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
                border: 1px solid #e0e0e0; border-radius: 6px; margin: 0 2px;
                background: #f5f5f5; color: #ccc; font-weight: bold;">«</span>

            <a th:if="${couponPage.hasPrevious()}"
               th:href="@{/my/coupon(page=${couponPage.number - 1})}"
               style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
              border: 1px solid #ddd; border-radius: 6px; margin: 0 2px;
              background: #fff; color: #946ccf; text-decoration: none; font-weight: bold;">‹</a>
            <span th:unless="${couponPage.hasPrevious()}"
                  style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
                border: 1px solid #e0e0e0; border-radius: 6px; margin: 0 2px;
                background: #f5f5f5; color: #ccc; font-weight: bold;">‹</span>

            <th:block th:each="i : ${#numbers.sequence(0, couponPage.totalPages - 1)}">
                <a th:if="${i != couponPage.number}"
                   th:href="@{/my/coupon(page=${i})}"
                   th:text="${i + 1}"
                   style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
                  border: 1px solid #ddd; border-radius: 6px; margin: 0 2px;
                  background: #fff; color: #555; text-decoration: none; font-weight: 600;"></a>
                <span th:if="${i == couponPage.number}"
                      th:text="${i + 1}"
                      style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
                    border: 1px solid #946ccf; border-radius: 6px; margin: 0 2px;
                    background: linear-gradient(135deg, #a86cc1, #946ccf); color: #fff;
                    font-weight: 700;"></span>
            </th:block>

            <a th:if="${couponPage.hasNext()}"
               th:href="@{/my/coupon(page=${couponPage.number + 1})}"
               style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
              border: 1px solid #ddd; border-radius: 6px; margin: 0 2px;
              background: #fff; color: #946ccf; text-decoration: none; font-weight: bold;">›</a>
            <span th:unless="${couponPage.hasNext()}"
                  style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
                border: 1px solid #e0e0e0; border-radius: 6px; margin: 0 2px;
                background: #f5f5f5; color: #ccc; font-weight: bold;">›</span>

            <a th:if="${couponPage.number < couponPage.totalPages - 1}"
               th:href="@{/my/coupon(page=${couponPage.totalPages - 1})}"
               style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
              border: 1px solid #ddd; border-radius: 6px; margin: 0 2px;
              background: #fff; color: #946ccf; text-decoration: none; font-weight: bold;">»</a>
            <span th:unless="${couponPage.number < couponPage.totalPages - 1}"
                  style="display: inline-block; width: 36px; height: 36px; line-height: 36px;
                border: 1px solid #e0e0e0; border-radius: 6px; margin: 0 2px;
                background: #f5f5f5; color: #ccc; font-weight: bold;">»</span>

            <div style="margin-top: 12px; font-size: 13px; color: #999;">
                <th:block th:text="${couponPage.number + 1} + ' / ' + ${couponPage.totalPages}"></th:block>
            </div>
        </div>

    </div>
</main>

<div th:replace="~{my/_tail.html}"></div>