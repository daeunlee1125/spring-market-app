<div th:replace="~{my/_head.html}"></div>

<main class="container">
    <div class="sidebar">
        <ul>
            <li><a th:href="@{/my/home}" class="active">마이페이지 홈</a></li>
            <li><a th:href="@{/my/order}">전체주문내역</a></li>
            <li><a th:href="@{/my/point}">포인트내역</a></li>
            <li><a th:href="@{/my/coupon}">쿠폰</a></li>
            <li><a th:href="@{/my/review}">나의리뷰</a></li>
            <li><a th:href="@{/my/qna}">문의하기</a></li>
            <li><a th:href="@{/my/info}">나의설정</a></li>
        </ul>
    </div>
    <div class="content">
        <div class="main-content-header">
            <h2>나의 쇼핑 정보</h2>
            <div class="info-summary">
                <div class="info-item">
                    <div class="count" th:text="${orderCount}">2</div>
                    <div>주문</div>
                </div>
                <div class="info-item">
                    <div class="count" th:text="${couponCount}">1</div>
                    <div>쿠폰</div>
                </div>
                <div class="info-item">

                    <div class="count" th:text="${#numbers.formatInteger(pointTotal, 0, 'COMMA')}">1,000</div>
                    <div>포인트</div>
                </div>
                <div class="info-item">
                    <div class="count" th:text="${qnaCount}">1</div>
                    <div>문의</div>
                </div>
            </div>
        </div>
        <div style="width: 810px; height: 86px; background-color: #eee; text-align: center; line-height: 86px; margin-bottom: 20px;">
            810 x 86 배너 광고
        </div>

        <div class="section">
            <div class="section-header">
                <h3>최근 주문내역</h3>
            </div>
            <table class="table-container">
                <thead>
                <tr>
                    <th>날짜</th>
                    <th>상품정보</th>
                    <th>상태</th>
                    <th>확인 / 신청</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="orderItem : ${recentOrders}">
                    <td th:text="${#dates.format(orderItem.ord_date, 'yyyy-MM-dd')}">2022-12-13</td>

                    <td>
                        <div class="product-info">
                            <img src="/images/placeholder.png" alt="상품 이미지">
                            <div class="product-details">
                                <p>주문번호 : <a href="#" th:text="${orderItem.ord_no}" onclick="openModal('orderDetailPopup')">1012211341</a></p>
                                <p>(주) <a href="#" onclick="openModal('sellerInfoPopup')">상호명</a></p>
                                <p>상품명 : <span th:text="${orderItem.item_name}">상품명</span></p>
                                <p>수량 : <span th:text="${orderItem.item_cnt}">1</span>개</p>
                                <strong th:if="${productMap[orderItem.prod_no] != null}"
                                        th:text="${#numbers.formatInteger(productMap[orderItem.prod_no].prod_price, 0, 'COMMA')} + '원'">34,000원</strong>
                                <strong th:if="${productMap[orderItem.prod_no] == null}">가격 정보 없음</strong>
                            </div>
                        </div>
                    </td>
                    <td th:switch="${orderItem.item_stat}">
                        <span th:case="1">배송전</span>
                        <span th:case="2">배송중</span>
                        <span th:case="3">배송완료</span>
                        <span th:case="4">구매확정</span>
                        <span th:case="*">상태없음</span>
                    </td>

                    <td>
                        <button onclick="openModal('confirmModal')">구매확정</button>
                        <button onclick="openModal('reviewModal')">상품평쓰기</button>
                        <button onclick="openModal('returnModal')">반품신청</button>
                        <button onclick="openModal('exchangeModal')">교환신청</button>
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(recentOrders)}">
                    <td colspan="4" style="text-align: center;">최근 주문 내역이 없습니다.</td>
                </tr>
                </tbody>
            </table>
            <br>
            <a th:href="@{/my/order}" class="more-link">더보기 &gt;</a>
        </div>

        <div class="section">
            <div class="section-header">
                <h3>포인트적립내역</h3>
            </div>
            <table class="table-container">
                <thead>
                <tr>
                    <th>날짜</th>
                    <th>구분</th>
                    <th>주문번호</th>
                    <th>적립금액</th>
                    <th>비고</th>
                    <th>유효기간</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="point : ${recentPoints}">
                    <td th:text="${point.p_date}">2022-12-13</td>
                    <td>
                        <span th:if="${point.p_type == 1}">적립</span>
                        <span th:if="${point.p_type == 2}">사용</span>
                        <span th:unless="${point.p_type == 1 or point.p_type == 2}">기타</span>
                    </td>
                    <td></td> <td th:text="${#numbers.formatInteger(point.p_point, 0, 'COMMA')}">340</td>
                    <td th:text="${point.p_info}">상품구매확정</td>
                    <td th:text="${point.p_exp_date}">2024-12-10</td>
                </tr>
                <tr th:if="${#lists.isEmpty(recentPoints)}">
                    <td colspan="6" style="text-align: center;">포인트 내역이 없습니다.</td>
                </tr>
                </tbody>
            </table>
        </div>
        <br>
        <a th:href="@{/my/point}" class="more-link">더보기 &gt;</a>

        <div class="section">
            <div class="section-header">
                <h3>상품평</h3>
            </div>
            <table class="table-container">
                <thead>
                <tr>
                    <th>번호</th>
                    <th>상품명</th>
                    <th>내용</th>
                    <th>별점</th>
                    <th>작성일</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="review, status : ${recentReviews}">
                    <td th:text="${status.count}">1</td>
                    <td th:text="${review.prodName}">상품번호 / 상품명</td>
                    <td th:text="${review.rev_content}">배송이 빠릅니다.. 잘 사용하겠습니다.</td>
                    <td>
                        <strong class="star-rating" th:text="${review.rev_rating}">★★★★★</strong>
                    </td>
                    <td th:text="${#dates.format(review.rev_rdate, 'yyyy-MM-dd')}">2022-12-10</td>
                </tr>
                <tr th:if="${#lists.isEmpty(recentReviews)}">
                    <td colspan="5" style="text-align: center;">상품평 내역이 없습니다.</td>
                </tr>
                </tbody>
            </table>
        </div>
        <br>
        <a th:href="@{/my/review}" class="more-link">더보기 &gt;</a>

        <div class="section">
            <div class="section-header">
                <h3>나의 문의</h3>
            </div>
            <table class="table-container">
                <thead>
                <tr>
                    <th>번호</th>
                    <th>문의유형</th>
                    <th>문의제목</th>
                    <th>작성일</th>
                    <th>상태</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="qna, status : ${recentQnas}">
                    <td th:text="${status.count}">1</td>
                    <td th:text="${qna.q_cate1}">고객센터</td>
                    <td th:text="${qna.q_title}">신용카드 결제 중 오류가 난 경우 어떻게 하나요?</td>
                    <td th:text="${qna.q_rdate}">2022-12-12</td>
                    <td th:text="${#strings.isEmpty(qna.q_reply)} ? '답변 대기' : '답변 완료'">답변 완료</td>
                </tr>
                <tr th:if="${#lists.isEmpty(recentQnas)}">
                    <td colspan="5" style="text-align: center;">문의 내역이 없습니다.</td>
                </tr>
                </tbody>
            </table>
        </div>
        <br>
        <a th:href="@{/my/qna}" class="more-link">더보기 &gt;</a>
    </div>
</main>
<div th:replace="~{my/modal.html}"></div>
<div th:replace="~{my/_tail.html}"></div>